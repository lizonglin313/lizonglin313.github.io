<html>
<head>
    <meta charset="utf-8"/>
<meta name="description" content=""/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ä½¿ç”¨Golangæ„å»ºåŒºå—é“¾Part1ï¼šåŸºæœ¬åŸå‹ | Big Carrot</title>
<link rel="shortcut icon" href="https://lizonglin313.github.io//favicon.ico?v=1580652641921">
<link href="https://cdn.bootcss.com/font-awesome/5.11.2/css/all.css" rel="stylesheet">
<link rel="stylesheet" href="https://lizonglin313.github.io//styles/main.css">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

<script src="https://cdn.bootcss.com/highlight.js/9.15.10/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dockerfile.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dart.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/go.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>

<!-- DEMO JS -->
<script src="media/scripts/index.js"></script>



    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
</head>
<body>
<div class="main gt-bg-theme-color-first">
    <nav class="navbar navbar-expand-lg">
    <div class="navbar-brand">
        <img class="user-avatar" src="/images/avatar.png" alt="å¤´åƒ">
        <div class="site-name gt-c-content-color-first">
            Big Carrot
        </div>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-bars gt-c-content-color-first" style="font-size: 18px"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center">
            
                <div class="nav-item">
                    
                        <a href="/" class="menu gt-a-link">
                            é¦–é¡µ
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/archives" class="menu gt-a-link">
                            å½’æ¡£
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/tags" class="menu gt-a-link">
                            æ ‡ç­¾
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/post/about" class="menu gt-a-link">
                            å…³äº
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/post/friends" class="menu gt-a-link">
                            æœ‹å‹
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/post/indexlink" class="menu gt-a-link">
                            å¸¸ç”¨ç«™ç‚¹
                        </a>
                    
                </div>
            
        </div>
    </div>
</nav>
    <div class="post-container">
        <div class="post-detail gt-bg-theme-color-second">
            <article class="gt-post-content">
                <h2 class="post-title">
                    ä½¿ç”¨Golangæ„å»ºåŒºå—é“¾Part1ï¼šåŸºæœ¬åŸå‹
                </h2>
                <div class="post-info">
                    <time class="post-time gt-c-content-color-first">
                        Â· 2019-09-04 Â·
                    </time>
                    
                        <a href="https://lizonglin313.github.io/tag/Kf9p2vgKYl" class="post-tags">
                            # Golang
                        </a>
                    
                        <a href="https://lizonglin313.github.io/tag/AHTdTb5Fm" class="post-tags">
                            # ç¬”è®°
                        </a>
                    
                </div>
                <div class="post-content">
                    <h2 id="æœ€å‰é¢">æœ€å‰é¢</h2>
<p>è¿™ä¸ªç³»åˆ—çš„åšå®¢æ˜¯å—äº†<a href="https://github.com/AnnatarHe">AnnatarHe</a>çš„å¯å‘ï¼Œä»–å°†<a href="https://jeiwan.cc/">JeiWan</a>çš„__ã€ŠBuilding Blockchain in Goã€‹__ç³»åˆ—æ–‡ç« è¿›è¡Œäº†ç¿»è¯‘ã€‚äºæ˜¯æˆ‘è¦åŠç¿»è¯‘åŠè½¬è½½çš„å°½é‡å®Œæˆè¿™ç³»åˆ—åšå®¢ã€‚</p>
<h2 id="references">References</h2>
<p>ä¸ºäº†ä¸åœ¨ä»¥åå¿˜è®°ï¼Œæˆ‘å°†__ã€Šä½¿ç”¨Golangæ„å»ºåŒºå—é“¾ã€‹__ç³»åˆ—åšå®¢çš„å‚è€ƒã€å¼•ç”¨ã€è½¬è½½ç­‰ä¿¡æ¯å†™åœ¨æœ€å‰é¢ï¼š</p>
<ul>
<li><a href="https://github.com/AnnatarHe">AnnatarHe</a> è¿™æ˜¯ç¿»è¯‘è€…çš„åšå®¢åœ°å€ï¼Œå…·ä½“æ–‡ç« åœ¨ä»–çš„ä¸»é¡µé‡Œã€‚æˆ‘å¾ˆå–œæ¬¢ä»–çš„ä¸€äº›æ–‡ç« ï¼ŒåŒ…æ‹¬éæŠ€æœ¯æ–‡ï¼Œæœ‰ä¸€ç§åƒæ˜¯â€œè¯»äº†å¾ˆå¤šå¾ˆå¤šä¹¦ã€å­¦äº†å¾ˆå¤šå¾ˆå¤šçŸ¥è¯†çš„å¦ä¸€ä¸ªæˆ‘â€ï¼Œæˆ–è®¸æˆ‘ä»¬åœ¨æ€§æ ¼ä¸Šæœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ã€‚</li>
<li><a href="https://jeiwan.cc/">JeiWan</a> æœ¬ç³»åˆ—æ–‡ç« çš„åŸåˆ›ä½œè€…ï¼Œæˆ‘å¾ˆå–œæ¬¢ä»–çš„åšå®¢åå­—__Going the distance__ã€‚</li>
<li><a href="https://github.com/liuchengxu/blockchain-tutorial">Githubä¸Šå¦ä¸€ä¸ªä¸­æ–‡ç¿»è¯‘ç‰ˆæœ¬ï¼Œè¡¥å……äº†å¾ˆå¤šè¦ç‚¹</a></li>
</ul>
<p>ä»¥ä¸Šï¼Œè‡´è°¢ï¼</p>
<h2 id="ä»‹ç»">ä»‹ç»</h2>
<p>åŒºå—é“¾æ˜¯21ä¸–çºªæœ€å…·æœ‰é©å‘½æ€§çš„æŠ€æœ¯ï¼Œå®ƒæŠ€æœ¯è¶³å¤Ÿæˆç†Ÿè€Œä¸”æ½œåŠ›å°šæœªå®Œå…¨å‘æ˜ã€‚åœ¨æœ¬è´¨ä¸Šï¼ŒåŒºå—é“¾æ˜¯ä¸€ä¸ªå¯ä»¥è®°å½•æ•°æ®çš„åˆ†å¸ƒå¼æ•°æ®åº“ã€‚ä½†ç‹¬ç‰¹çš„æ˜¯å®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªéšç§çš„æ•°æ®åº“è€Œæ˜¯ä¸€ä¸ªå…¬å¼€çš„ï¼Œæ¯ä¸€ä¸ªä½¿ç”¨å®ƒçš„äººå¯ä»¥å¯¹å®ƒå®Œå…¨æˆ–è€…éƒ¨åˆ†æ‹·è´ã€‚å¹¶ä¸”ï¼Œä¸€æ¡æ–°çš„è®°å½•æƒ³è¦åŠ å…¥ï¼Œå¿…é¡»ç»è¿‡æ‰€æœ‰ç»´æŒå®ƒçš„äººï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰çš„åŒæ„ã€‚åŒºå—é“¾ä½¿å¾—åŠ å¯†è´§å¸ä»¥åŠæ™ºèƒ½åˆçº¦æˆä¸ºå¯èƒ½ã€‚</p>
<p>åœ¨æ¥ä¸‹æ¥çš„ä¸€ç³»åˆ—æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨åŒºå—é“¾æŠ€æœ¯æ¥æ„å»ºä¸€ä¸ªç®€å•çš„åŠ å¯†è´§å¸ç³»ç»Ÿã€‚</p>
<h2 id="åŒºå—">åŒºå—</h2>
<p>è®©æˆ‘ä»¬ä»â€œåŒºå—é“¾â€çš„ç»„æˆâ€œåŒºå—â€å¼€å§‹ã€‚åŒºå—é“¾ä¸­ï¼ŒåŒºå—æ¥å­˜å‚¨æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚æ¯”å¦‚ï¼Œæ¯”ç‰¹å¸åŒºå—å­˜å‚¨äº¤æ˜“ä¿¡æ¯ï¼Œè¿™å°±æ˜¯åŠ å¯†è´§å¸çš„ç²¾é«“æ‰€åœ¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¸€ä¸ªåŒºå—è¿˜åŒ…å«ä¸€äº›æŠ€æœ¯ä¿¡æ¯ï¼Œå°±åƒå½“å‰çš„ç‰ˆæœ¬ï¼ŒåŒºå—æ‰€å­˜å‚¨çš„ä¿¡æ¯å°±åŒ…å«å½“å‰çš„æ—¶é—´æˆ³å’Œä¸Šä¸€ä¸ªåŒºå—çš„hashï¼ˆå“ˆå¸Œï¼‰ã€‚</p>
<p>æœ¬æ–‡ä¸­æˆ‘ä»¬å¹¶ä¸ä¼šæŒ‰ç…§æè¿°åŒºå—é“¾ä»¥åŠæ¯”ç‰¹å¸é‚£æ ·æ„å»ºä¸€ä¸ªååˆ†å®Œå¤‡çš„åŒºå—ï¼Œè€Œæ˜¯å®ç°ä¸€ä¸ªè¾ƒä¸ºç®€å•çš„ç‰ˆæœ¬ï¼Œä»…ä»…åŒ…å«å…³é”®çš„æŠ€æœ¯ä¿¡æ¯è¦ç‚¹ï¼Œå®ƒçœ‹èµ·æ¥å°±åƒä¸‹é¢ï¼š</p>
<pre><code class="language-go">type Block struct {
	Timestamp     int64			// æ—¶é—´æˆ³ï¼Œç”±å½“å‰åŒºå—åˆ›å»ºçš„æ—¶é—´è½¬åŒ–è€Œæ¥
	Data          []byte		// åŒºå—å­˜å‚¨çš„å®é™…çš„æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯äº¤æ˜“
	PrevBlockHash []byte		// å‰ä¸€ä¸ªåŒºå—çš„å“ˆå¸Œï¼Œä¹Ÿå«çˆ¶å“ˆå¸Œ
	Hash          []byte		// å½“å‰åŒºå—çš„å“ˆå¸Œ
}
</code></pre>
<p>åœ¨æ¯”ç‰¹å¸è§„æ ¼è¯´æ˜ä¸­ï¼ŒTimestampã€PrevBlockHashã€Hashå±äºåŒºå—å¤´ï¼ˆheadersï¼‰ï¼Œè¿™äº›å½¢æˆä¸€ä¸ªç‹¬ç«‹æ•°æ®ç»“æ„ï¼Œå®Œæ•´çš„æ¯”ç‰¹å¸åŒºå—å¤´çš„ç»“æ„å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Purpose</th>
<th>Updated when...</th>
<th>Size (Bytes)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Version</td>
<td>Block version number</td>
<td>You upgrade the software and it specifies a new version</td>
<td>4</td>
</tr>
<tr>
<td>hashPrevBlock</td>
<td>256-bit hash of the previous block header</td>
<td>A new block comes in</td>
<td>32</td>
</tr>
<tr>
<td>hashMerkleRoot</td>
<td>256-bit hash based on all of the transactions in the block</td>
<td>A transaction is accepted</td>
<td>32</td>
</tr>
<tr>
<td>Time</td>
<td>Current timestamp as seconds since 1970-01-01T00:00 UTC</td>
<td>Every few seconds</td>
<td>4</td>
</tr>
<tr>
<td>Bits</td>
<td>Current target in compact format</td>
<td>The difficulty is adjusted</td>
<td>4</td>
</tr>
<tr>
<td>Nonce</td>
<td>32-bit number (starts at 0)</td>
<td>A hash is tried (increments)</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>ä¸‹é¢æ˜¯æ¯”ç‰¹å¸ä¸­ä½¿ç”¨Golangè¯­è¨€å®ç°çš„btcdçš„BlockHeaderçš„å®ç°ï¼š</p>
<pre><code class="language-go">// BlockHeader defines information about a block and is used in the bitcoin
// block (MsgBlock) and headers (MsgHeaders) messages.
type BlockHeader struct {
    // Version of the block.  This is not the same as the protocol version.
    Version int32

    // Hash of the previous block in the block chain.
    PrevBlock chainhash.Hash

    // Merkle tree reference to hash of all transactions for the block.
    MerkleRoot chainhash.Hash

    // Time the block was created.  This is, unfortunately, encoded as a
    // uint32 on the wire and therefore is limited to 2106.
    Timestamp time.Time

    // Difficulty target for the block.
    Bits uint32

    // Nonce used to generate the block.
    Nonce uint32
}
</code></pre>
<p>è€Œäº¤æ˜“ï¼ˆåœ¨æˆ‘ä»¬è¿™é‡Œæ˜¯Dataï¼‰åˆ™æ˜¯å¦ä¸€ä¸ªç‹¬ç«‹çš„æ•°æ®ç»“æ„ã€‚æ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬ä¸ºäº†ç®€å•è¿™æ ·æ¥å¤„ç†ã€‚åœ¨çœŸæ­£çš„æ¯”ç‰¹å¸ä¸­ï¼ŒåŒºå—çš„æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Size</th>
</tr>
</thead>
<tbody>
<tr>
<td>Magic no</td>
<td>value always 0xD9B4BEF9</td>
<td>4 bytes</td>
</tr>
<tr>
<td>Blocksize</td>
<td>number of bytes following up to end of block</td>
<td>4 bytes</td>
</tr>
<tr>
<td>Blockheader</td>
<td>consists of 6 items</td>
<td>80 bytes</td>
</tr>
<tr>
<td>Transaction counter</td>
<td>positive integer VI = VarInt</td>
<td>1 - 9 bytes</td>
</tr>
<tr>
<td>transactions</td>
<td>the (non empty) list of transactions</td>
<td>-many transactions</td>
</tr>
</tbody>
</table>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•è®¡ç®—å“ˆå¸Œå‘¢ï¼Ÿå“ˆå¸Œçš„è®¡ç®—æ˜¯åŒºå—é“¾çš„ä¸€ä¸ªéå¸¸é‡è¦çš„ç‰¹ç‚¹ï¼Œè¿™ä¸ªç‰¹ç‚¹ä½¿å¾—åŒºå—é“¾æ˜¯å®‰å…¨çš„ã€‚è®¡ç®—å“ˆå¸Œåœ¨è®¡ç®—æ–¹é¢ä¸Šæ˜¯ä¸€ä»¶éå¸¸å›°éš¾çš„æ“ä½œï¼Œå³ä½¿åœ¨ä¸€äº›æ€§èƒ½éå¸¸å¥½çš„è®¡ç®—æœºä¸Šä¹Ÿè¦èŠ±äº›æ—¶é—´ï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆäººä»¬ä½¿ç”¨æ€§èƒ½æ›´åŠ å¼ºåŠ²çš„GPUæ¥æŒ–æ¯”ç‰¹å¸ï¼‰ã€‚è¿™æ˜¯ä¸€ç§åˆ»æ„çš„ç»“æ„è®¾è®¡ï¼Œä½¿å¾—å‘åŒºå—é“¾ä¸­æ·»åŠ åŒºå—æ˜¯ä¸€ä»¶éå¸¸å›°éš¾çš„äº‹æƒ…ï¼Œç”±æ­¤é˜²æ­¢æ·»åŠ åŒºå—ååˆè¿›è¡Œä¿®æ”¹ã€‚æˆ‘ä»¬å°†åœ¨åç»­çš„æ–‡ç« è®¨è®ºå¹¶å®ç°è¿™ä¸ªæœºåˆ¶ã€‚</p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬æ‹¿åˆ°äº†åŒºå—å­—æ®µï¼Œç„¶åè¿æ¥èµ·æ¥ï¼Œä½¿ç”¨SHA-256å“ˆå¸Œå»è®¡ç®—è¿æ¥èµ·æ¥çš„ç»„åˆï¼Œæˆ‘ä»¬åœ¨__SetHash__å‡½æ•°ä¸­åšè¿™äº›å†…å®¹ï¼š</p>
<pre><code class="language-go">func (b *Block) SetHash() {
	timestamp := []byte(strconv.FormatInt(b.Timestamp, 10))
	headers := bytes.Join([][]byte{b.PrevBlockHash, b.Data, timestamp}, []byte{})
	hash := sha256.Sum256(headers)

	b.Hash = hash[:]
}
</code></pre>
<p>æ¥ç€ï¼ŒæŒ‰ç…§Golangçš„æƒ¯ä¾‹ï¼Œæˆ‘ä»¬å°†å®ç°ä¸€ä¸ªç®€å•çš„åˆ›å»ºåŒºå—çš„å‡½æ•°__NewBlockâ€‹__ï¼š</p>
<pre><code class="language-go">func NewBlock(data string, prevBlockHash []byte) *Block {
	block := &amp;Block{time.Now().Unix(), []byte(data), prevBlockHash, []byte{}}
	block.SetHash()
	return block
}
</code></pre>
<p>è¿™å°±æ˜¯åŒºå—ã€‚</p>
<h2 id="åŒºå—é“¾">åŒºå—é“¾</h2>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬å®ç°åŒºå—é“¾ã€‚åŒºå—é“¾çš„æœ¬è´¨æ˜¯ä¸€ä¸ªå…·æœ‰ç¡®å®šç»“æ„çš„æ•°æ®åº“ï¼šä¸€ä¸ªæœ‰åºçš„ï¼Œå‘åè¿æ¥ï¼ˆæ–°åŒºå—ç”±å‰ä¸€ä¸ªåŒºå—ç”Ÿæˆï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å‘åè¿­ä»£ï¼‰çš„åˆ—è¡¨ã€‚ä¹Ÿå°±æ„å‘³ç€ï¼Œæ¯ä¸ªæ–°åŒºå—çš„æ’å…¥æ˜¯è¿æ¥ç€å‰ä¸€ä¸ªåŒºå—çš„ã€‚è¿™ç§ç»“æ„ä½¿å¾—å¯ä»¥å¿«é€Ÿçš„å¾—åˆ°å‰é¢çš„åŒºå—å¹¶ä¸”ï¼ˆæœ‰æ•ˆçš„ï¼‰é€šè¿‡å“ˆå¸Œå€¼æ‰¾åˆ°æŸä¸ªåŒºå—ã€‚</p>
<p>åœ¨Golangä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <strong>array</strong> å’Œ <strong>map</strong> ç»“æ„æ¥å®ç°ï¼šæ•°ç»„å¯ä»¥ä¿è¯å“ˆå¸Œçš„æœ‰åºæ€§ï¼ˆGolangä¸­æ•°ç»„æ˜¯æœ‰åºçš„ï¼‰ï¼Œè€Œ <strong>map</strong> ï¼ˆ__map__æ˜¯æ— åºçš„ï¼‰å¯ä»¥ä¿è¯__å“ˆå¸Œ__åˆ°__åŒºå—__çš„æ˜ å°„ã€‚ä½†æ˜¯åœ¨æˆ‘ä»¬çš„åŒºå—é“¾åŸå‹ä¸­ï¼Œæˆ‘ä»¬ä»…ä½¿ç”¨ä¸€ä¸ªæ•°ç»„ï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨ä¸éœ€è¦é€šè¿‡å“ˆå¸Œå»å¯»æ‰¾åŒºå—ã€‚</p>
<pre><code class="language-go">type Blockchain struct {
	blocks []*Block
}
</code></pre>
<p>è¿™æ˜¯æˆ‘ä»¬ç¬¬ä¸€ä¸ªåŒºå—é“¾ï¼Œæˆ‘ä»æ²¡æƒ³è¿‡ä¼šè¿™ä¹ˆç®€å• ğŸ˜‰</p>
<p>ç°åœ¨ï¼Œè®©æ·»åŠ åŒºå—æˆä¸ºå¯èƒ½ï¼š</p>
<pre><code class="language-go">func (bc *Blockchain) AddBlock(data string) {
	prevBlock := bc.blocks[len(bc.blocks)-1]
	newBlock := NewBlock(data, prevBlock.Hash)
	bc.blocks = append(bc.blocks, newBlock)
}
</code></pre>
<p>å°±æ˜¯è¿™æ ·ï¼Œå“¦ä¸...</p>
<p>è¦åŠ å…¥ä¸€ä¸ªæ–°çš„å—ï¼Œæˆ‘ä»¬å¿…é¡»è¦æœ‰ä¸€ä¸ªå·²ç»å­˜åœ¨çš„åŒºå—ï¼Œä½†æ˜¯ç°åœ¨åŒºå—é“¾ä¸­æ²¡æœ‰åŒºå—ã€‚æ‰€ä»¥ï¼Œåœ¨ä»»ä½•åŒºå—é“¾ä¸­ï¼Œå¿…é¡»æœ‰è‡³å°‘ä¸€ä¸ªåŒºå—ï¼Œè¿™ç§åŒºå—ï¼Œæ˜¯é“¾çš„ç¬¬ä¸€ä¸ªï¼Œå«åš__genesis__ <strong>block</strong>ï¼ˆåˆ›ä¸–çºªå—ï¼‰ï¼Œè®©æˆ‘ä»¬å®ç°ä¸€ä¸ªæ–¹æ³•æ¥åˆ›é€ è¿™æ ·ä¸€ä¸ªå—ï¼š</p>
<pre><code class="language-go">func NewGenesisBlock() *Block {
	return NewBlock(&quot;Genesis Block&quot;, []byte{})
}
</code></pre>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œä½¿ç”¨__genesis__ __block__æ¥åˆ›å»ºä¸€ä¸ªåŒºå—é“¾ï¼š</p>
<pre><code class="language-go">func NewBlockchain() *Blockchain {
	return &amp;Blockchain{[]*Block{NewGenesisBlock()}}
}
</code></pre>
<p>ç„¶æˆ‘ä»¬æ¥æ£€æŸ¥è¿™ä¸ªåŒºå—é“¾çš„å·¥ä½œæ˜¯å¦æ­£ç¡®ï¼š</p>
<pre><code class="language-go">func main() {
	bc := NewBlockchain()

	bc.AddBlock(&quot;Send 1 BTC to Ivan&quot;)
	bc.AddBlock(&quot;Send 2 more BTC to Ivan&quot;)

	for _, block := range bc.blocks {
		fmt.Printf(&quot;Prev. hash: %x\n&quot;, block.PrevBlockHash)
		fmt.Printf(&quot;Data: %s\n&quot;, block.Data)
		fmt.Printf(&quot;Hash: %x\n&quot;, block.Hash)
		fmt.Println()
	}
}
</code></pre>
<p>è¾“å‡ºï¼š</p>
<pre><code class="language-go">Prev. hash:
Data: Genesis Block
Hash: aff955a50dc6cd2abfe81b8849eab15f99ed1dc333d38487024223b5fe0f1168

Prev. hash: aff955a50dc6cd2abfe81b8849eab15f99ed1dc333d38487024223b5fe0f1168
Data: Send 1 BTC to Ivan
Hash: d75ce22a840abb9b4e8fc3b60767c4ba3f46a0432d3ea15b71aef9fde6a314e1

Prev. hash: d75ce22a840abb9b4e8fc3b60767c4ba3f46a0432d3ea15b71aef9fde6a314e1
Data: Send 2 more BTC to Ivan
Hash: 561237522bb7fcfbccbc6fe0e98bbbde7427ffe01c6fb223f7562288ca2295d1
</code></pre>
<p>å°±æ˜¯è¿™æ ·äº†ï¼</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>æˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªéå¸¸ç®€å•çš„åŒºå—é“¾åŸå‹ï¼šä»…ä»…æ˜¯åŒºå—æ•°ç»„ï¼Œæ¯ä¸€ä¸ªåŒºå—è¿æ¥åˆ°å®ƒå‰ä¸€ä¸ªåŒºå—ã€‚çœŸå®çš„åŒºå—æ›´åŠ çš„å¤æ‚ã€‚åœ¨æˆ‘ä»¬çš„åŒºå—é“¾ä¸­æ·»åŠ æ–°çš„åŒºå—æ˜¯éå¸¸ç®€å•å¹¶ä¸”è¿…é€Ÿçš„ï¼Œä½†æ˜¯åœ¨çœŸæ­£çš„åŒºå—é“¾ä¸­æ·»åŠ åŒºå—éœ€è¦è¿™æ ·çš„å·¥ä½œï¼šä¸€æ˜¯åœ¨æ·»åŠ åŒºå—ä¹‹å‰éœ€è¦è¿›è¡Œååˆ†ç¹é‡çš„è®¡ç®—ï¼ˆè¿™ä¸ªæœºåˆ¶å«åšProof-of-Wordå·¥ä½œé‡è¯æ˜ï¼‰ã€‚åŒæ—¶ï¼ŒåŒºå—é“¾æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œæ²¡æœ‰å•ç‹¬çš„å†³ç­–è€…ã€‚å› æ­¤ï¼Œä¸€ä¸ªæ–°çš„åŒºå—å¿…é¡»è¢«è¿™ä¸ªç½‘ç»œï¼ˆåŒºå—é“¾ç½‘ç»œï¼‰çš„å‚ä¸è€…ä»¬ç¡®è®¤å’Œæ‰¿è®¤ï¼ˆè¿™ä¸ªæœºåˆ¶å«å…±è¯†æœºåˆ¶ï¼‰ã€‚åˆ«å¿˜äº†æˆ‘ä»¬ç°åœ¨åŒºå—ä¸­è¿˜æ²¡æœ‰äº¤æ˜“ï¼</p>
<p>åé¢çš„æ–‡ç« ä¸­æˆ‘ä»¬å°†è¦†ç›–åˆ°æ‰€æœ‰çš„è¿™äº›è¦ç‚¹ã€‚</p>
<p>Links:</p>
<ol>
<li>Full source codes: <a href="https://github.com/Jeiwan/blockchain_go/tree/part_1">https://github.com/Jeiwan/blockchain_go/tree/part_1</a></li>
<li>Block hashing algorithm: <a href="https://en.bitcoin.it/wiki/Block_hashing_algorithm">https://en.bitcoin.it/wiki/Block_hashing_algorithm</a></li>
</ol>

                </div>
            </article>
        </div>

        
            <div class="next-post">
                <div class="next gt-c-content-color-first">ä¸‹ä¸€ç¯‡</div>
                <a href="https://lizonglin313.github.io/post/ä¹¦å•" class="post-title gt-a-link">
                    ä¹¦å•
                </a>
            </div>
        

        

        <div class="site-footer gt-c-content-color-first">
    <div class="slogan gt-c-content-color-first">äººä»¬ä¾ç„¶ç›¸ä¿¡æœªæ¥ä¼šæ›´ç²¾å½©</div>
    <div class="social-container">
        
            
                <a href="https://github.com/lizonglin313" target="_blank">
                    <i class="fab fa-github gt-c-content-color-first"></i>
                </a>
            
        
            
        
            
                <a href="https://weibo.com/u/3645767403?nick=lizonglin_TNcarrot" target="_blank">
                    <i class="fab fa-weibo gt-c-content-color-first"></i>
                </a>
            
        
            
        
            
        
            
        
    </div>
    <a>--Â©2017-2020</a><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv"><a>--æœ¬ç«™æ€»è®¿é—®é‡</a><a><span id="busuanzi_value_site_pv"></span></a><a>æ¬¡--</a></span><a>Powered by </a> <a href="https://github.com/getgridea/gridea" target="_blank"> Gridea--</a> | <a href="https://lizonglin313.github.io//atom.xml" target="_blank">RSS</a>
</div>

<script>
    hljs.initHighlightingOnLoad()
</script>


    </div>
</div>
</body>
</html>
